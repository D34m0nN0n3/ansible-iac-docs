Настройка правил аудита событий на CentOS/RHEL с помощью Ansible
================================================================
Роль генерирует набор правил для отслеживания системных вызовов. 

.. note::
   По умолчанию отслеживаются следующие события: вызов загружаемых модулей ядра, изменение параметров ядра, установленные сетевые соединения, создание файлов с правами root'а, доступ к файлам не системными пользователями, неавторизованный доступ, запуск Docker контейнеров, модификация политик sudoers, изменение файла "/etc/passwd", создание и модификация локальных пользователей и групп, изменения конфигурации сетевых настроек, удаление журналов, переименование и смена прав на файлы журналов, запись выполненных команд из под root'а и не системных пользователей.
   
.. note::
   Минимальный набор правил отслеживает события: изменение параметров ядра, создание файлов с правами root'а, модификация политик sudoers, изменение файла "/etc/passwd", изменения конфигурации сетевых настроек, удаление журналов, переименование и смена прав на файлы журналов, запись выполненных команд из под root'а и не системных пользователей.

В таблице ниже приведен перечень ключей с информацией о фильтрующем событии: 

.. table:: Keys
    =============================== ============================================================
    Key                             INFO                                                        
    =============================== ============================================================
    auditkernel                     Вызов загружаемых модулей ядра.                             
    auditconf                       Изменение параметров ядра.                                  
    auditconn                       Установленные сетевые соединения.                           
    audit-rootfile                  Создание файлов с правами root'а.                           
    audit-userfile                  Доступ к файлам не системными пользователями.               
    auditfaccessauditfaccess        Неавторизованный доступ.                                    
    auditdocker                     Запуск Docker контейнеров.                                  
    sudo_modification               Модификация политик sudoers.                                
    passwd_modification             Изменение файла "/etc/passwd".                              
    user_modification               Создание и модификация локальных пользователей.             
    group_modification              Создание и модификация локальных групп.                     
    network и network_modifications Изменения конфигурации сетевых настроек.                    
    deletelog                       Удаление журналов.                                          
    accesslog                       Переименование и смена прав на файлы журналов.              
    rootcmd                         Запись выполненных команд из под root'а.                    
    usercmd                         Запись выполненных команд из под не системных пользователей.
    =============================== ============================================================

Для просмотра события используестя команда: ``ausearch -k <key>``

Дополнительные переменные
~~~~~~~~~~~~~~~~~~~~~~~~~
*Переменные указаны в файле: vars/main.yml* 
Для данного проекта зарезервированы следующие переменные приведенные в таблице ниже:

.. table:: Vars
    =========================== ============================================
    Var                         INFO                                        
    =========================== ============================================
    auditd_conf_lineinfile      Задает список опций для настройки auditd.   
    auditd_custom_rules         Задает список дополнительных правил аудита. 
    min_audit                   Генерирует минимальный набор правил.
    =========================== ============================================

*В настройке auditd изменены следующие опции: `max_log_file = 50` - ограничение на размер файла в мегабайтах, `num_logs = 10` - максимальное число файлов, `disp_qos = lossless` - разрешить ли блокирование при взаимодействии с диспетчером, для передачи информации диспетчеру используется буфер размером 128 кб. (https://access.redhat.com/solutions/3025421)*

Теги
~~~~

.. table:: tags
    =============== ===========================
    Tag             INFO                      
    =============== ===========================
    change_rules    Модификация правил аудита.
    =============== ===========================
